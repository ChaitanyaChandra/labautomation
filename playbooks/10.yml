- name: Install and configure Kuburnetes Master Node
  hosts: all
  become: yes
  tasks:
    - debug:
        msg: |
          Note: This automation works only if you set the hostname of the servers as kube-master 
          for master node, Otherwise it is going to fail

    - wait_for: timeout=10
    
    - name: Create Kuburnetes Yum repo file
      blockinfile:
        path: /etc/yum.repos.d/kuburnetes.repo
        create: yes
        block: |
          [kuburnetes]
          name=virt7-docker-common-release
          baseurl=http://cbs.centos.org/repos/virt7-docker-common-release/x86_64/os/
          gpgcheck=0
          enabled=1

    - name: Install required packages
      yum:
        name: "{{item}}"
        state: latest
        update_cache: yes
        enablerepo: kuburnetes
      with_items:
        - etcd
        - flannel
        - kubernetes

    #- name: Update Kuburnetes config 
    #  block